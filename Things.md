##摘要
心血管疾病是导致全世界人口死亡的首要原因，这种情况在除了非洲以外的其他国际和地区同样存在。心电是心脏活动过程中产生的生物电信号在体表的反映，能客观的映射出心脏的生理状态。动态心电图出现以来，心电的数据量急剧增加，传统方法由医生的手工分析已经不太现实。心电信号的自动分析技术得到很大发展，现在市场上已经出现多种心电自动分析软件和便携式心电监护设备。  
心电信号幅度小，频率低，采集信号时干扰严重，因此心电信号的滤波预处理是波形特征提取的前提。当然预处理也会使心电信号有用信号丢失一部分，从而直接影响心电信号自动分析的结果。  
基线漂移噪声是心电噪声中的主要成分，因此矫正基线漂移是心电信号预处理的重要一步。矫正ECG信号中基线漂移的方法包括小波变换、曲线拟合以及FIR和IIR滤波方法，但因计算量过大、受实时性特点影响和截止频率影响，矫正的效率不高。本文提出数学形态滤波器的方法，根据心电信号的几何特征设计参数。经验证取得良好效果。  
QRS波群作为心电图信号最为明显的特征，不仅包含心室肌收缩等重要心脏生理信息，而且检测QRS波群也是检测其他波形的前提。本文采用一种自适应差分阈值的方法来检测QRS波群，该方法通过心电信号的特征进行自适应学习，获取的阈值作为标准来检测R波。使得检测准确性受基线漂移和R波幅度影响较小。  
**关键词：**心电信号；滤波；数学形态学；QRS波群；差分；阈值；自适应
#1 前言
##1.1研究背景与意义
当今社会生活节奏加快，生活工作压力也与日俱增，出现了各种威胁人类健康的疾病，其中心血管疾病成为威胁人类健康最主要的因素，并且发病率逐年上升。世界卫生组织公布一项数据显示，2013年心血管疾病共夺走1730万条生命，占总死亡人数的31.0%，比起1990年的1230万（总死亡人数的25.8%）提升了不少。心血管疾病(cardiovascular disease)是指关于心脏或血管的疾病，又称循环系统疾病。很多心血管疾病就是没有及时发现病变，耽误治疗而导致死亡。  
心电图检查因其方法简单，诊断可靠，对病人无损害等优点，在心脏病的诊断中有着极其重要的作用。心电图检查也是临床上诊断心血管疾病的主要方法，随着电子计算机的发展，利用计算机对ECG信号进行检测和分析有效的提高了诊断效率，减少医生诊断时主观因素的影响。实时的心电特征值检测在心电图机甚至手术室、ICU都会有很重要的应用。随着移动互联网时代的来临，可用于数据采集的便携式可穿戴设备也可以采集心电数据，在设备上甚至服务器云端都可以用检测算法来分析数据，做到实时、高效。在心脏病等心血管疾病发病前，心电信号是有明显异常的，如果这些异常能被检测算法提前检测出来，做出预警，那么对于心脏病的抢救具有巨大的积极意义。
##1.2国内外研究状态分析
1903年，荷兰医生、生理学家埃因托芬发明了弦线式检流计，从而带来了心电图历史上的第一次突破。埃因托芬把心电图中的一系列波分别命名为P波，Q波，R波，S波和T波，并且描述了一些心血管系统疾病的心电图特点。为了表彰他的此项发现，他于1924年获得诺贝尔医学与生理学奖。  
虽然我们今天仍然在使用那个时代的理论来分析心电图，但是近年来心电描记术领域已经出现了微小的进展。比如，心电记录仪器已经从实验室中的笨重的设备演变成了今天非常便携的装置，并且计算机心电图分析也参与其中。  
###1.2.1 心电信号预处理的研究现状
一般而言，正常人的心电信号幅度为10uV~5mV，频率在0.15Hz~150Hz之间，其中90%的心电信号能量集中在0.25Hz~35Hz之间。要获得心电信号很不容易，不仅仅是因为心电信号的强度小、频率低，而且各种类型的噪声会包含在心电信号的波形中。这些噪声包含肌肉噪声，由于探测电极的移动造成的人为噪声，电源线的干扰，基线漂移和T波高频类似于QRS复合体。  
基线漂移是人的呼吸运动，还有电极在皮肤上的轻微移动移动所引起的，频率一般低于5Hz。基线漂移能够直接影响心电信号的上下位置，给心电信号在图纸上的打印和对心电图的直接诊断带来麻烦。由于这种数据的不确定性，不适用大多数的QRS波检测算法。还有工频干扰是用电设备产生的干扰，其频率与环境中的交流电的频率一致，欧美地区一般为60Hz；在我国和其他国家地区的频率为50Hz。除此之外还有一些电极的接触不良或者脱落、剧烈运动等造成的干扰。有一种方法是利用数字滤波器，它能减弱这些噪声的影响，因此可以提高信噪比。在许多文献的提出的QRS检测器中，对于噪声的过滤正在逐步的加以重视。   
为了去除心电信号的噪声干扰，国内外研究人员做出来大量的工作，涌现出许多方法，比如经典的数字滤波技术，自适应滤波技术、小波变换、数学形态学、神经网络及独立分量的分析等。从这些常用的方法比较来看，经典滤波器的算法简单，容易实现，但其截止频率固定，去噪不灵活。特别是FIR滤波器中，10Hz的通带对于算法有很大的计算量；IIR滤波器对原始数据有一定的改变。自适应滤波技术通过对传统的滤波器技术进行改进，它能够根据噪声频率的变化自适应的调节来逐步逼近最优值，弥补了传统滤波器的截止频率固定的不足。这种滤波方法的缺陷是需要一个参考信号，但是参考信号不容易得到。神经网络法需要学习训练，样本的选取需要有很好的代表性。近年来，小波理论也得到了不断完善和发展，基于小波变换的去噪和检测得到广泛的运用。小波变换阈值去噪法是根据信号与噪声的频谱特性的不同进行滤波，能够较好的去除噪声并且保持心电信号波形不失真，但计算量过大是它的一个缺点。  
数学形态学是一种基于集合理论、格论和拓扑学基础上的图像分析学科，是数学形态学图像处理的基本理论。在滤除基线漂移的过程中，主要用到的运算为腐蚀和膨胀，开运算和闭运算。数学形态学最基本的概念是结构元素，它本身具有一定形态（如点、线段和圆等），相当于一个探针，不断移动进行匹配。在数据量不大的情况下，能够快速彻底的消除基线漂移。
###1.2.2 QRS波群检测的研究现状
心电图特征值的精确识别，为医生诊断任何心脏疾病以及心律失常的分类提供有用信息。如今QRS波的检测已有多种方法，总的来说，这些方法都已经运用在实时检测心电图波峰中。这些措施包括数字滤波器、模版匹配、差分法、小波变换和神经网络。  
20世纪七八十年代以来，Willis J. Tompkins教授所做的工作具有开创性意义，他提出一种实时检测心电QRS波算法具有很大影响。在这之后西安交通大学的郑崇勋教授等使用小波变换检测心电特征值的方法，也是一种主流的检测方法。
数字滤波器法是由线性数字滤波、非线性变换和决策算法三个部分组成。首先用一组数字滤波器滤除分析对象以外的信息、达到抑制噪声干扰的目的，以便于提取出QRS波特特征的信息。通常的做法是采用带通滤波，提高5～30Hz频率范围内信号的分量，使QRS波群的能量得到加强。然后采用阈值判断、斜率判断等方法对特征点进行判断，实现检测R波的目的，并采取一些补偿策略提高检测的准确度。采用滤波器方法的缺点是容易受到噪声干扰，且准确度有待提高。
人工神经网络(ANN，Artificial Neural Network)是近年来迅速发展的一种新型计算机和人工智能技术。它能够模拟人脑机理和功能的，具有鲁棒性、非线性、高度并行性和自组织适应性等基本特性。人工神经网络是一种自适应非线性预测器，其基本原理是根据过去的采样点来预测当前的采样点。但是它需要大量的学习训练，这个过程一般要花费较多的时间，而且训练的样本要具有一定的代表性，实施起来有一定困难。而且对于心电QRS波群检测来说，不同的个体的波形形态差比较大，这样学习和训练的样本量要很大，而且样本的选取要有足够好的代表性。随着科学技术的进步，在心电信号特征值检测领域，神经网络检测方法的潜力无疑是最大的。  
还有模版匹配法，心电信号可以看作类周期信号，利用心电信号的这一特性，可以将QRS波群近似认为固定的模板。其原理是把ECG信号与预先存储的波形模板逐点比较，当两者的耦合度达到指定的阈值时，认为检测到ORs波群。该方法计算量较大，当使用的模版为多个时，需要逐一计算。另外如果被检者的心电波形与模板中存储样本的形态相差很大，易造成QRS波群漏检。  
电子计算机技术的发展使得心电信号检测算法在时间复杂度、空间复杂度上没有较大的限制，但是科学研究工作者们对于检测算法程序能够运行得更快，体积更小的追求从未停止。  
##1.3 本文的主要内容
论文的安排如下：  
第1部分，首先简述了心电自动分析技术的研究背景和意义，对该领域研究的现状，发展方向做简要的概括。也对本课题的的主要研究内容做简单介绍。  
第2部分，本部分介绍心电信号的产生机理和波形特征，常用的数据库，已经本文要用到的MIT-BIH数据库及Windows平台下的开发工具包WFDB；再介绍本课题的开发工具Visual C++ 6.0。  
第3部分，先介绍数学形态学的基本理论和方法，然后运用形态学理论滤除心电信号的基线漂移，最后做实验仿真及分析。
第4部分，采用自适应差分阈值发检测R波


